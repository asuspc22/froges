"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.assertiveAppConfigProvider = exports.adjustLegacyAppId = exports.appConfigKey = exports.appConfigShape = void 0;
const tslib_1 = require("tslib");
const t = tslib_1.__importStar(require("io-ts"));
const ari_1 = require("../ari");
const config_1 = require("../config");
const ui_1 = require("../ui");
exports.appConfigShape = t.interface({
    id: t.string
});
exports.appConfigKey = 'app';
function adjustLegacyAppId(legacyAppDetails) {
    if (legacyAppDetails.id.startsWith('ari:')) {
        return legacyAppDetails;
    }
    return Object.assign(Object.assign({}, legacyAppDetails), { id: (0, ari_1.appIdToAriString)(legacyAppDetails.id) });
}
exports.adjustLegacyAppId = adjustLegacyAppId;
const assertiveAppConfigProvider = (appConfigReader) => () => (0, config_1.assertive)(appConfigReader).readConfigSectionOrThrow(ui_1.Text.config.missing, ui_1.Text.config.invalid).then(adjustLegacyAppId);
exports.assertiveAppConfigProvider = assertiveAppConfigProvider;
