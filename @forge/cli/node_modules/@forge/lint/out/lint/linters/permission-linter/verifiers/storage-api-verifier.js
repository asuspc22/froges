"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.StorageAPIVerifier = void 0;
const linter_interface_1 = require("../../../linter-interface");
const verifier_interface_1 = require("../../verifier-interface");
const text_1 = require("../../../text");
const STORAGE_PERMISSION = 'storage:app';
class StorageAPIVerifier extends verifier_interface_1.BaseLintIssueVerifier {
    getLintClass() {
        return linter_interface_1.LintClass.Error;
    }
    async process(apiCalls) {
        var _a, _b;
        if ((_b = (_a = this.manifest.permissions) === null || _a === void 0 ? void 0 : _a.scopes) === null || _b === void 0 ? void 0 : _b.includes(STORAGE_PERMISSION)) {
            return [];
        }
        return apiCalls.map((apiCall) => (Object.assign(Object.assign({ class: this.getLintClass(), message: text_1.messages.verifiers.storage.message(STORAGE_PERMISSION), reference: text_1.messages.verifiers.storage.reference }, apiCall), { metadata: {
                missingPermission: STORAGE_PERMISSION
            } })));
    }
}
exports.StorageAPIVerifier = StorageAPIVerifier;
